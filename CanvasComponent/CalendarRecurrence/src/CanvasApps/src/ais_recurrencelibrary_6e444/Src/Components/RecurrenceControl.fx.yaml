RecurrenceControl As CanvasComponent:
    Fill: =RGBA(0, 0, 0, 0)
    Height: =500
    OnReset: |
        =Clear(colSelectedWeekdays);
        SetFocus(dteStartDate);
    RecurrencePattern: |-
        ={
            type: ddRepeatType.Selected.type,
            interval: ddRepeatCnt.Selected.Value,
            daysOfWeek: Table(ShowColumns(colSelectedWeekdays,WeekdayName))
        }
    Width: =575
    X: =0
    Y: =0
    ZIndex: =1

    conRecurrenceRoot As groupContainer.verticalAutoLayoutContainer:
        Height: =Parent.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =32
        PaddingLeft: =32
        PaddingRight: =32
        PaddingTop: =32
        RadiusBottomLeft: =4
        RadiusBottomRight: =4
        RadiusTopLeft: =4
        RadiusTopRight: =4
        Width: =Parent.Width
        ZIndex: =1

        lblRepeat As Text:
            DisplayMode: =DisplayMode.Edit
            Height: =48
            LayoutMinHeight: =32
            LayoutMinWidth: =96
            Size: =24
            Text: ="Repeat"
            Width: =112
            X: =0
            Y: =0
            ZIndex: =1

        conStartDate As groupContainer.horizontalAutoLayoutContainer:
            FillPortions: =0
            Height: =55
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            ZIndex: =2

            lblStartDate As Text:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Size: =18
                Text: ="Start"
                Width: =55
                X: =0
                Y: =0
                ZIndex: =1

            "dteStartDate As 'Date picker'":
                Appearance: ='DatePickerCanvas.Appearance'.FilledLighter
                DisplayMode: =DisplayMode.Edit
                FontSize: =16
                FontUnderline: =false
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =320
                Width: =225
                X: =0
                Y: =0
                ZIndex: =2

        conRepeatEvery As groupContainer.horizontalAutoLayoutContainer:
            FillPortions: =0
            Height: =55
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGap: =8
            LayoutMinHeight: =55
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            ZIndex: =3

            icoRepeat As Icon:
                DisplayMode: =DisplayMode.Edit
                Height: =28
                Icon: ="ArrowSync"
                LayoutMinHeight: =32
                LayoutMinWidth: =32
                Width: =28
                X: =0
                Y: =0
                ZIndex: =1

            lblRepeatEvery As Text:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Size: =16
                Text: ="Repeat every"
                Width: =96
                X: =0
                Y: =0
                ZIndex: =2

            ddRepeatCnt As Dropdown.pcfdataset:
                Appearance: ='DropdownCanvas.Appearance'.FilledLighter
                DisplayMode: =DisplayMode.Edit
                Height: =32
                Items: =Sequence(10)
                LayoutMinHeight: =32
                LayoutMinWidth: =320
                Width: =64
                X: =0
                Y: =0
                ZIndex: =3

            ddRepeatType As Dropdown.pcfdataset:
                AlignInContainer: =AlignInContainer.Center
                Appearance: ='DropdownCanvas.Appearance'.FilledLighter
                DefaultSelectedItems: =
                DisplayMode: =DisplayMode.Edit
                Height: =32
                Items: |
                    =Table(
                        {
                            typeId: 1,
                            type: "daily",
                            typeDisplayName: "day(s)"
                        },
                        {
                            typeId: 2,
                            type: "weekly",
                            typeDisplayName: "week(s)"
                        },
                        {
                            typeId: 3,
                            type: "monthly",
                            typeDisplayName: "month(s)"
                        },
                        {
                            typeId: 4,
                            type: "yearly",
                            typeDisplayName: "year(s)"
                        }
                    )
                LayoutMinHeight: =32
                LayoutMinWidth: =320
                PaddingLeft: =4
                PaddingRight: =0
                PaddingTop: =0
                Width: =90
                X: =0
                Y: =0
                ZIndex: =4

                typeDisplayName2 As PowerApps_CoreControls_DropdownCanvasTemplate_dataField.textualColumn:
                    FieldDisplayName: ="typeDisplayName"
                    FieldName: ="typeDisplayName"
                    FieldType: ="s"
                    FieldVariantName: ="textualColumn"
                    Order: =1
                    ZIndex: =8

        conWeekdays As groupContainer.verticalAutoLayoutContainer:
            FillPortions: =0
            Height: =75
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Visible: =ddRepeatType.Selected.typeId = 2
            ZIndex: =4

            "galWeekdays As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0'":
                AlignInContainer: =AlignInContainer.Center
                BorderColor: =App.Theme.Colors.Darker40
                DelayItemLoading: =true
                Items: |-
                    =Table({WeekdayInitial: "M", WeekdayName: "Monday"},{WeekdayInitial: "T", WeekdayName: "Tuesday"},{WeekdayInitial: "W", WeekdayName: "Wednesday"},{WeekdayInitial: "T", WeekdayName: "Thursday"},{WeekdayInitial: "F", WeekdayName: "Friday"},{WeekdayInitial: "S", WeekdayName: "Saturday"},{WeekdayInitial: "S", WeekdayName: "Sunday"}) 
                LayoutMinHeight: =55
                LayoutMinWidth: =320
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =55
                Width: =400
                ZIndex: =1

                btnWeekday As Button:
                    Appearance: =If(ThisItem in colSelectedWeekdays, 'ButtonCanvas.Appearance'.Primary, 'ButtonCanvas.Appearance'.Secondary)
                    BorderRadiusBottomLeft: =5
                    BorderRadiusBottomRight: =5
                    BorderRadiusTopLeft: =5
                    BorderRadiusTopRight: =5
                    DisplayMode: =DisplayMode.Edit
                    Height: =40
                    OnSelect: =If(ThisItem in colSelectedWeekdays, RemoveIf(colSelectedWeekdays, WeekdayName = ThisItem.WeekdayName), Collect(colSelectedWeekdays, ThisItem));
                    Text: =ThisItem.WeekdayInitial
                    Width: =40
                    X: =(Parent.TemplateWidth - Self.Width) / 2
                    Y: =(Parent.TemplateHeight - Self.Height) / 2
                    ZIndex: =1

        conRepeatUntil As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.Center
            FillPortions: =0
            Height: =100
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutJustifyContent: =LayoutJustifyContent.Center
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutWrap: =true
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            Width: =335
            ZIndex: =6

            lblOccurenceText As Text:
                AutoHeight: =true
                DisplayMode: =DisplayMode.Edit
                FillPortions: =1
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Text: =$"Occurs every {Concat(colSelectedWeekdays, ThisRecord.WeekdayName, ", ")} until"
                Width: =125
                X: =0
                Y: =0
                ZIndex: =1

            conRepeatUntilDate As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =45
                LayoutMinHeight: =112
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =4
                PaddingLeft: =1
                PaddingTop: =4
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Visible: =varEndDateEnabled
                Width: =285
                ZIndex: =2

                "dteRepeatUntilDate As 'Date picker'":
                    Appearance: ='DatePickerCanvas.Appearance'.FilledLighter
                    DisplayMode: =DisplayMode.Edit
                    FontSize: =12
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =320
                    Width: =150
                    X: =0
                    Y: =0
                    ZIndex: =1

                btnRemoveEndDate As Button:
                    Appearance: ='ButtonCanvas.Appearance'.Transparent
                    DisplayMode: =DisplayMode.Edit
                    FontItalic: =false
                    FontSize: =12
                    FontUnderline: =true
                    Height: =32
                    LayoutMinHeight: =32
                    LayoutMinWidth: =96
                    OnSelect: =Set(varEndDateEnabled, false);
                    Text: ="Remove end date"
                    Width: =125
                    X: =0
                    Y: =0
                    ZIndex: =2

            btnEnableEndDate As Button:
                Appearance: ='ButtonCanvas.Appearance'.Transparent
                DisplayMode: =DisplayMode.Edit
                FontSize: =12
                FontUnderline: =true
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                OnSelect: =Set(varEndDateEnabled, true);
                Text: ="Choose end date"
                Visible: =!varEndDateEnabled
                Width: =125
                X: =0
                Y: =0
                ZIndex: =3

        conActionButtons As groupContainer.horizontalAutoLayoutContainer:
            Height: =225
            LayoutAlignItems: =LayoutAlignItems.End
            LayoutGap: =32
            LayoutJustifyContent: =LayoutJustifyContent.End
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =24
            PaddingRight: =24
            RadiusBottomLeft: =4
            RadiusBottomRight: =4
            RadiusTopLeft: =4
            RadiusTopRight: =4
            ZIndex: =7

            btnSave As Button:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Text: ="Save"
                Width: =96
                X: =0
                Y: =0
                ZIndex: =1

            btnDiscard As Button:
                Appearance: ='ButtonCanvas.Appearance'.Secondary
                DisplayMode: =DisplayMode.Edit
                Height: =32
                LayoutMinHeight: =32
                LayoutMinWidth: =96
                Text: ="Discard"
                Width: =96
                X: =0
                Y: =0
                ZIndex: =2

    btnReset As Button:
        Appearance: ='ButtonCanvas.Appearance'.Transparent
        DisplayMode: =DisplayMode.Edit
        Height: =32
        Icon: ="ArrowClockwise"
        Layout: ='ButtonCanvas.Layout'.IconOnly
        OnSelect: =Reset(RecurrenceControl)
        Text: =
        Width: =40
        X: =-40
        Y: =-40
        ZIndex: =2

